<!doctype html>
<html>
  <head>
    <title>Language Background</title>

    //<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="jquery-1-11-1-min.js"></script>
    <script src="jspsych-5.0.3/jspsych.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-text.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-html.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-survey-text.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-survey-likert.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-single-stim.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-single-audio.js" type="text/javascript"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-call-function.js"></script>
    <link href="jspsych-5.0.3/css/jspsych.css" rel="stylesheet" type="text/css"></link>

// <script>
//   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
//   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
//   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
//   })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
// 
//   ga('create', 'UA-98928148-1', 'auto');
//   ga('send', 'pageview');
// 
// </script>

  </head>
  <body>
  </body>
  <script>

  /* define welcome message block */
  var welcome_block = {
    type: "text",
    text: "<p>Welcome to the experiment.</p>" +
		"<p>First you will answer some basic questions" +
		" about your language background with Welsh and English.</p>" +
		"Press any key to begin."
  };

// typed responses
var first_page = {
  type: 'survey-text',
  questions: ["What is your name?", "How old are you?", "What gender do you identify with?", "Current place of residence (City, Country)", "What is your highest level of formal education?", "What hand do you write with?"],
};

// page variables
var qs_lang_history_welsh = [
	"At what age did you <b>start learning</b> Welsh?",
	"At what age did you <b>start to feel comfortable</b> using Welsh?",
	"How many years of <b>classes (grammar, history, math, etc.)</b> have you had in Welsh?",
	"How many years have you spent in <b>a country/region</b> where Welsh is spoken?",
	"How many years have you spent in <b>a family</b> where Welsh is spoken?",
	"How many years have you spent in <b>a work environment</b> where Welsh is spoken?"
	];

var qs_lang_history_english = [
	"At what age did you <b>start learning</b> English?",
	"At what age did you <b>start to feel comfortable</b> using English?",
	"How many years of <b>classes (grammar, history, math, etc.)</b> have you had in English?",
	"How many years have you spent in <b>a country/region</b> where English is spoken?",
	"How many years have you spent in <b>a family</b> where English is spoken?",
	"How many years have you spent in <b>a work environment</b> where English is spoken?"
	];

var qs_lang_use_1 = [
	"1a: In an average week, what percentage of the time do you use <b>Welsh</b> with friends?",
	"1b: In an average week, what percentage of the time do you use <b>English</b> with friends?",
	];

var qs_lang_use_2 = [
	"2a: In an average week, what percentage of the time do you use <b>Welsh</b> with family?",
	"2b: In an average week, what percentage of the time do you use <b>English</b> with family?",
	];

var qs_lang_use_3 = [
	"3a: In an average week, what percentage of the time do you use <b>Welsh</b> at school/work?",
	"3b: In an average week, what percentage of the time do you use <b>English</b> at school/work?"
	];

var qs_lang_use_4 = [
	"4a: When you talk to yourself, how often do you talk to yourself in <b>Welsh</b>?",
	"4b: When you talk to yourself, how often do you talk to yourself in <b>English</b>?",
	];

var qs_lang_use_5 = [
	"5a: When you count, how often do you count in <b>Welsh</b>?",
	"5b: When you count, how often do you count in <b>English</b>?"
	];

var qs_lang_prof_welsh = [
	"How well do you <b>speak</b> Welsh?",
	"How well do you <b>understand</b> Welsh?",
	"How well do you <b>read</b> Welsh?",
	"How well do you <b>write</b> Welsh?"
	];

var qs_lang_prof_english = [
	"How well do you <b>speak</b> English?",
	"How well do you <b>understand</b> English?",
	"How well do you <b>read</b> English?",
	"How well do you <b>write</b> English?"
	];

var qs_lang_att_welsh = [
	"I feel like myself when I speak <b>Welsh</b>.",
	"I identify with a <b>Welsh-speaking</b> culture.",
	"It is important to me to use (or eventually use) <b>Welsh</b> like a native speaker.",
	"I want others to think I am a native speaker of <b>Welsh</b>."
	];

var qs_lang_att_english = [
	"I feel like myself when I speak <b>English</b>.",
	"I identify with a <b>English-speaking</b> culture.",
	"It is important to me to use (or eventually use) <b>English</b> like a native speaker.",
	"I want others to think I am a native speaker of <b>English</b>."
	];

// response scales
var scale_0_20 = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20+"];

var scale_0_100_perc = ["0%", "10%", "20%", "30%", "40%", "50%", "60%", "70%", "80%", "90%", "100%"];

var scale_well = ["Not well at all", "Not well", "Not that well", "Neutral", "Okay", "Well", "Very well"];

var scale_agree = ["Strongly Disagree", "Disagree", "Slightly Disagree", "Neutral", "Slightly Agree", "Agree", "Strongly Agree"];

var history_page_welsh = {
    type: 'survey-likert',
    questions: qs_lang_history_welsh,
    labels: [scale_0_20, scale_0_20, scale_0_20, scale_0_20, scale_0_20, scale_0_20]
};

var history_page_english = {
    type: 'survey-likert',
    questions: qs_lang_history_english,
    labels: [scale_0_20, scale_0_20, scale_0_20, scale_0_20, scale_0_20, scale_0_20]
};

var use_page_1 = {
    type: 'survey-likert',
    preamble: "Please ensure that percentages add up to 100.",
    questions: qs_lang_use_1,
    labels: [scale_0_100_perc, scale_0_100_perc]
};

var use_page_2 = {
    type: 'survey-likert',
    preamble: "Please ensure that percentages add up to 100.",
    questions: qs_lang_use_2,
    labels: [scale_0_100_perc, scale_0_100_perc]
};

var use_page_3 = {
    type: 'survey-likert',
    preamble: "Please ensure that percentages add up to 100.",
    questions: qs_lang_use_3,
    labels: [scale_0_100_perc, scale_0_100_perc]
};

var use_page_4 = {
    type: 'survey-likert',
    preamble: "Please ensure that percentages add up to 100.",
    questions: qs_lang_use_4,
    labels: [scale_0_100_perc, scale_0_100_perc]
};

var use_page_5 = {
    type: 'survey-likert',
    preamble: "Please ensure that percentages add up to 100.",
    questions: qs_lang_use_5,
    labels: [scale_0_100_perc, scale_0_100_perc]
};

var proficiency_page_welsh = {
    type: 'survey-likert',
    questions: qs_lang_prof_welsh,
    labels: [scale_well, scale_well, scale_well, scale_well]
};

var proficiency_page_english = {
    type: 'survey-likert',
    questions: qs_lang_prof_english,
    labels: [scale_well, scale_well, scale_well, scale_well]
};

var attitudes_page_welsh = {
    type: 'survey-likert',
    questions: qs_lang_att_welsh,
    labels: [scale_agree, scale_agree, scale_agree, scale_agree]
};

var attitudes_page_english = {
    type: 'survey-likert',
    questions: qs_lang_att_english,
    labels: [scale_agree, scale_agree, scale_agree, scale_agree]
};

  /* define instructions block */
  var instructions_block = {
    type: "text",
text: "<p>Thank you for completing the background survey.</p>",
    timing_post_trial: 2000
};

function saveData(filename, filedata){
   $.ajax({
      type:'post',
      cache: false,
      url: 'saveData.php', // this is the path to the above PHP script
      data: {filename: filename, filedata: filedata}
   });
}

  /* generate a random subject ID */
var subject_id = Math.floor(Math.random()*100000);

  /* record the condition assignment in the jsPsych data */
  /* this adds a property called 'subject' to every trial */
jsPsych.data.addProperties({
  subject: subject_id
}); 

var save_data = {
	type: 'call-function',
	func: function(data){
           saveData('backform-'+subject_id+'.csv', jsPsych.data.dataAsCSV());
}
};

var local_save = {
	type: 'call-function',
func: function(data){
jsPsych.data.localSave('backform-'+subject_id+'.csv', 'csv');
            }
};

  /* create experiment timeline array */
  var timeline = [];
  timeline.push(welcome_block);
  timeline.push(first_page);
  timeline.push(history_page_welsh);
  timeline.push(history_page_english);
  timeline.push(use_page_1);
  timeline.push(use_page_2);
  timeline.push(use_page_3);
  timeline.push(use_page_4);
  timeline.push(use_page_5);
  timeline.push(proficiency_page_welsh);
  timeline.push(proficiency_page_english);
  timeline.push(attitudes_page_welsh);
  timeline.push(attitudes_page_english);
  timeline.push(local_save);
  timeline.push(instructions_block);

  /* start the experiment */
  jsPsych.init({
    timeline: timeline //,
	//on_finish: function(){ saveData('backform-'+subject_id+'.csv', jsPsych.data.get().csv()); }
});
</script>
</html>